---
# - name: Update and generate SSL files
#   hosts: pvehomelab
#   become: true
#   gather_facts: true

#   roles:
#     # - basics
#     # - storager_drive
#     # - snapraid
#     # - mergerfs
#     # - openssl_generate_certificate # don't need now
#     - docker

- name: Install all apps
  hosts: pvehomelab
  become: true
  gather_facts: false

  roles:
    # - role: install_tsdproxy_tailscale # don't need now
    # - role: cloudflare_tunnel # don't need now
    # IMPORTANT: Need to remove *.shajalslab.top and shajalslab.top from local DNS resolver. 
    # Need to create an A record in Cloudflare pointing to any IP(192.168.8.3)
    # Wait until certificates are generated. command: "docker logs traefik"
    # - role: install_traefik
    # - role: install_portainer
    # - role: install_nextcloud
    # - role: install_syncthing
    # - role: install_rclone
    # - role: postgresql
    # - role: rustdesk
    # - role: cloud_sync_cron
    # - role: samba_share
    # - role: install_uptimeKuma
    # - role: notification_script
    # - role: system_monitoring
    # - role: pangolin_newt
    # New backup and restore roles included
    # - role: install_docmost
    # - role: install_immich
    # - role: install_homarr
    # - role: install_linkwarden
    # - role: install_matrix_synapse
    # - role: install_media_packages
    - role: install_n8n
      vars:
        host_type: "local"  # options: local, vps

# - name: Install node_exporter for Proxmox host resource monitor with Grafana
#   hosts: proxmoxhost
#   become: true
#   gather_facts: false

#   roles:
#     - proxmox_host_resource_monitor_grafana

